{
  "name": "I2. Affectionate Arrays (Hard Version)",
  "time_limit": "time limit per test3 seconds",
  "memory_limit": "memory limit per test512 megabytes",
  "input": "InputEach test contains multiple test cases. The first line of input contains an integer $$$t$$$ ($$$1 \\leq t \\leq 10^5$$$) — the number of test cases. The description of test cases follows.The first line of each test case contains a single integer $$$n$$$ ($$$1 \\leq n \\leq 3\\cdot 10^6$$$) — the length of the array $$$a_1, a_2, \\ldots, a_n$$$.The second line of each test case contains $$$n$$$ integers $$$a_1, a_2, \\ldots, a_n$$$ ($$$-10^9 \\leq a_i \\leq 10^9$$$) — the initial array. It is guaranteed that $$$\\max(\\lvert a_i\\rvert) \\leq \\sum a_i$$$.It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$3\\cdot 10^6$$$.",
  "output": "OutputFor each test case, output a single line containing an integer: the sum of values of valid arrays $$$b_1, b_2, \\ldots, b_m$$$, modulo $$$998\\,244\\,353$$$.",
  "description": "I2. Affectionate Arrays (Hard Version)time limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard output"
}