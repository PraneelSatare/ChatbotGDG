1255B - Fridge LockersAuthor: I_love_tigersugar ft. MikeMirzayanov. Prepared by UncleGrandpa TutorialModelize the problemWe modelize the problem as graph, where each fridge is a vertex and each chain is an edge between two vertexes. The problem is now equivalent to: Given a graph with n vertexes, each vertex has a value ai≥0. We have to add m edges to the graph such that each vertex is connected to at least two different vertexes and the total cost of edges added is minimum. The cost of an edge is the sum of value of its two end-points. Observe some basic properties of graphNow, each edge added will increase the sum of degree of all vertexes by 2. So adding m edges will make the sum of degree equal to 2×m. Since each vertexes must be connected to at least 2 other vertexes, the minimum sum of degree is 2×n.  Case 1: 2×m<2×n⇔m<n In this case, it is obvious that the answer is −1.  Case 2: 2×m=2×n⇔m=n In this case, it is easy to see that the degree of each vertex will be exactly 2. As a result, no matter what edges we add, the result is still 2×(a1+a2+...+an). But please take note that if n=2, then the answer will be −1 since for each vertex we have at most 1 different vertex to connect to.   Case 3(Of the original, pre-modified version of the problem): 2×m>2×n⇔m>n Please read this excellent answer by Um_nik. All credit goes to him for the excellent proof. 