{
  "name": "F2. Xor of Median (Hard Version)",
  "time_limit": "time limit per test3 seconds",
  "memory_limit": "memory limit per test256 megabytes",
  "input": "InputEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 10^4$$$). The description of the test cases follows. The first line of each test case contains two integers $$$k$$$ and $$$m$$$ ($$$1 \\le k \\le 2 \\cdot 10^5$$$, $$$1 \\le m \\le 10^9$$$) — the number of bits in $$$n$$$ and the upper bound on the elements in sequence $$$a$$$.The second line of each test case contains a binary string of length $$$k$$$ — the binary representation of $$$n$$$ with no leading zeros.It is guaranteed that the sum of $$$k$$$ over all test cases does not exceed $$$2\\cdot 10^5$$$.",
  "output": "OutputFor each test case, output a single integer representing the bitwise XOR of the median of all good sequences $$$a$$$ of length $$$n$$$ where $$$0\\le a_i < m$$$.",
  "tags": []
}